"use strict";if(window.Another===undefined&&(window.Another={}),jQuery===undefined)throw new Error("Another currently uses jQuery v2.x as a dom helper");(function(a){var IsNullOrUndefined;if(a.Helpers={EndsWith:function(n,t){return!a.Helpers.StringIsNullOrEmpty(n)&&n.lastIndexOf(t)===n.length-t.length},StripLast:function(n){if(n===undefined||n===null||n==="")throw new Error("EndsWith: str cannot be null, empty or undefined");return n.substr(0,n.length-1)},StartsWith:function(n,t){return!a.Helpers.StringIsNullOrEmpty(n)&&n.substr(0,t.length)===t},StripFirst:function(n){if(n===undefined||n===null||n==="")throw new Error("EndsWith: str cannot be null, empty or undefined");return n.substr(1)},StringIsNullOrEmpty:function(n){return n===undefined||n===null||n===""},IsUndefinedOrNull:function(n){return n===undefined||n===null},Any:function(n,t){if(a.Helpers.IsUndefinedOrNull(t))throw new Error("Helpers.Any: lambda cannot be undefined");return!a.Helpers.IsUndefinedOrNull(n)&&n.length>0&&t(n).length>0},IsFunc:function(n){return!a.Helpers.IsUndefinedOrNull(n)&&typeof n=="function"},IsArray:function(n){return Object.prototype.toString.call(n)==="[object Array]"},GetRandom:function(n){var t="xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx".replace(/[xy]/g,function(n){var t=Math.random()*16|0,i=n=="x"?t:t&3|8;return i.toString(16)});return n?"id_"+t.replace("-",""):t},Clone:function(n){return JSON.parse(JSON.stringify(n))},EscapeRegExp:function(n){return n.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")},ReplaceAll:function(n,t,i){return n.replace(new RegExp(a.Helpers.EscapeRegExp(t),"g"),i)},FormatString:function(n,t){for(var r,i=0;i<t.length;i++)r=t[i],r=IsNullOrUndefined(r)?"":r.toString(),n=a.Helpers.ReplaceAll(n,"{"+i+"}",r);return n}},String.prototype.IsNullOrEmpty=function(){return a.Helpers.StringIsNullOrEmpty(this)},String.prototype.IsNullOrWhitespace=function(){return this.IsNullOrEmpty()||this.replace(/^\s+/,"").replace(/\s+$/,"")===""},Array.prototype.IsNullOrEmpty=function(){return a.Helpers.IsUndefinedOrNull(this)||this.length<1},Object.defineProperty(Object.prototype,"IsNullOrEmpty",{value:function(){return a.Helpers.IsUndefinedOrNull(this)},enumerable:!1}),IsNullOrUndefined=function(n){return a.Helpers.IsUndefinedOrNull(n)},!a.Helpers.StartsWith(jQuery.fn.jquery,"2."))throw new Error("Another currently uses jQuery v2.x as a dom helper");var checkAndFireFromObservable=function(t,i,r,u){i.Elements!==undefined&&i.Elements!==null&&i.Elements.length>0&&i.Elements.forEach(function(i){if(i.length>0)switch(i[0].tagName){case"INPUT":case"TEXTAREA":n(i,t,r,u,"keyup");break;case"SELECT":n(i,t,r,u,"change");break;default:i.html(u)}});a.Helpers.IsFunc(i.Callback)&&i.Callback(u,t)},n=function(n,t,i,r,u){n.data("an_change")===undefined&&(n.data("an_change",!0),n.bind(u,function(){n.data("change_from_element",!0);t[i]=n.val()}));n.data("change_from_element")===!0?n.data("change_from_element",!1):n.val(r)},t=function(n,t){return n.filter(function(n){return n.PropName===t})};a.ObservableArray=function(){function n(){var t=Object.create(Array.prototype);return t=Array.apply(t,arguments)||t,n.injectClassMethods(t),t}return n.injectClassMethods=function(t){for(var i in n.prototype)n.prototype.hasOwnProperty(i)&&(t[i]=n.prototype[i]);return t},n.fromArray=function(t){return n.apply(null,t)},n.isArray=function(n){var t=Object.prototype.toString.call(n);return t.toLowerCase()==="[object array]"},n.prototype={add:function(t){if(n.isArray(t))for(var i=0;i<t.length;i++)Array.prototype.push.call(this,t[i]);else Array.prototype.push.call(this,t);return this},addAll:function(){for(var n=0;n<arguments.length;n++)this.add(arguments[n]);return this},pushNoFire:function(n){return Array.prototype.push.call(this,n),this},push:function(t){return Array.prototype.push.call(this,t),n.prototype.checkRepeater.call(this,function(n){n.AddNewElement(t)}),this.fireChange(),this},pop:function(){return Array.prototype.pop.call(this),n.prototype.checkRepeater.call(this,function(n){n.RemoveLastElement()}),this.fireChange(),this},reverse:function(){return Array.prototype.reverse.call(this),n.prototype.checkRepeater.call(this,function(n){n.ReverseElements()}),this.fireChange(),this},slice:function(n,t){return Array.prototype.slice.call(this,n,t)},splice:function(t,i){var u=arguments,r,f;for(Array.prototype.splice.call(this,t,i),r=2,r;r<u.length;r++)f=u[r],Array.prototype.splice.call(this,t,0,f),t++;return n.prototype.checkRepeater.call(this,function(n){t===undefined?n.RemoveAllElements():n.SpliceElements(u)}),this.fireChange(),this},sort:function(){throw new Error("Type Another.ObservableArray cannot 'sort'");},shift:function(){var t=Array.prototype.shift.call(this);return n.prototype.checkRepeater.call(this,function(n){n.RemoveFirstElement()}),this.fireChange(),t},unshift:function(){var i=arguments,t=0,r;for(t;t<i.length;t++)r=i[t],Array.prototype.splice.call(this,0,0,r);return n.prototype.checkRepeater.call(this,function(n){n.AddElementsInFront(i)}),this.fireChange(),this},toString:function(){return"Another.ObservableArray"},setObservables:function(n,t,i,r){this.parentObj=n;this.childObjName=t;this.observables=i;this.fullName=r},fireChange:function(){var n=this,r=n,i=t(this.observables,this.fullName);i.length>0&&i.forEach(function(t){checkAndFireFromObservable(n.parentObj,t,n.childObjName,r)})},setRepeater:function(n){this.repeater=n},checkRepeater:function(n){!IsNullOrUndefined(this.repeater)&&a.Helpers.IsFunc(n)&&n(this.repeater)}},n}.call({});a.DomHelper=jQuery;a.RepeaterWrappers={};a.RepeaterWrapper=function(n,t){var i=this;if(this.opts=n,this.prsnt=t,this.el=t.Element(n.selector),this.prnt=this.el.parent(),this.prnt.length<=0&&(this.prnt=this.prsnt.DomHelper("<div />")),this.cloneText=this.el[0].outerHTML,this.el.remove(),this.data=n.data,this.data.toString()!=="Another.ObservableArray")throw new TypeError("RepeaterWrapper.data must be of type Another.ObservableArray");this.data.setRepeater(this);this.Element=function(){return i.el};this.CreateElement=function(){var n=i.prsnt.DomHelper(i.cloneText);return n.removeAttr("id"),n.children().each(function(n,t){var u=i.prsnt.DomHelper(t),r=u.attr("id");!IsNullOrUndefined(r)&&r.length>0&&u.attr("id",r+"_"+a.Helpers.GetRandom(!0))}),n};this.AddNewElement=function(n,t){if(t||this.firstBindingComplete===!0){var r=i.CreateElement();i.prnt.append(r);i.opts.onRowBinding(r,n);r.show()}};this.ReverseElements=function(){for(var t=i.prnt.children(),n=0;n<t.length;n++)i.prnt.prepend(t[n])};this.RemoveLastElement=function(){i.prnt.children().last().remove()};this.RemoveFirstElement=function(){i.prnt.children().first().remove()};this.RemoveAllElements=function(){i.prnt.children().remove()};this.AddElementsInFront=function(n){for(var f,t,e=i.prnt.children(),r=i.prsnt.DomHelper(e.get(0)),u=0;u<n.length;++u){f=n[u];t=i.CreateElement();i.opts.onRowBinding(t,f);t.show();r.length<1?i.prnt.append(t):u===0?r.before(t):r.after(t);r=t}};this.SpliceElements=function(n){var f=n[0],h=n[1],e=i.prnt.children(),c=f+(h-1),o,r,u,s,t;for(e.each(function(n,t){n>=f&&n<=c&&i.prsnt.DomHelper(t).addClass("tbm___")}),o=i.prnt.find(".tbm___"),o.remove(),r=i.prsnt.DomHelper(e.get(f-1)),u=2;u<n.length;++u){s=n[u];t=i.CreateElement();i.opts.onRowBinding(t,s);t.show();r.length<1?i.prnt.append(t):r.after(t);r=t}};this.data.forEach(function(n){i.AddNewElement(n,!0)});this.firstBindingComplete=!0};a.AnotherPresenter=function(n,i,r){function o(n,i,r){ts.RaiseEvent("OnModelChanged",{Model:ts.Model,NewVals:n});IsNullOrUndefined(r)&&(r="");n.forEach(function(n){var o=t(u,r+n.name);o.length>0&&o.forEach(function(t){var o=n.object[n.name],s;f(o)?(s=e(o,i,n.name,u,r+n.name),i[n.name]=s):checkAndFireFromObservable(i,t,n.name,o)})});ts.RaiseEvent("OnModelObserved",{Model:ts.Model,NewVals:n})}var ts=this,domHelper,u;if(IsNullOrUndefined(r)||r.length<1)throw new Error("Presenter: container must be at least one element");domHelper=a.GetDependency("DomHelper");this.DomHelper=domHelper;this.Container=r;this.Element=function(n){var t=ts.Container.find(n);return t.length<1&&(t=domHelper("<div />")),t};u=[];this.RunConditionals=function(){ts.PresenterConditionals.forEach(function(obj){var n=[];a.Helpers.IsArray(obj.selector)?obj.selector.forEach(function(t){n.push(ts.Container.find(t))}):typeof obj.selector=="string"&&n.push(ts.Container.find(obj.selector));n.forEach(function(el){var res=!1;typeof obj.boolCallback=="string"?eval("res = "+obj.boolCallback):res=obj.boolCallback();obj.conditional(el,res)})})};this.RunHtmlWrappers=function(){var n=0,t=Object.keys(a.PluginWrapper.prototype),i=function(){var u=t[n],r,f;u!=="Presenter"&&(r=u.toLowerCase(),f=ts.Container.find("[an-"+r+"]"),f.each(function(n,t){var e=ts.DomHelper(t),i={},f;a.DomHelper.each(t.attributes,function(n,t){a.Helpers.StartsWith(t.name,"an-"+r)&&(i[t.name.replace("an-"+r+"-","")]=t.value)});f=a.PresenterPlugins[u];IsNullOrUndefined(f.wrapperProp)||(i[f.wrapperProp]=e.attr("an-"+r));ts.Plugins[u](t,i)}));n++;n<t.length&&i()};i();n=0;t=Object.keys(a.PresenterConditionals);i=function(){var condName=t[n],nmLower=condName.toLowerCase(),r=ts.Container.find("[an-"+nmLower+"]");r.each(function(i,el){var jEl=ts.DomHelper(el),foundPlugin=a.PresenterConditionals[condName],evalStr="ts.Conditionals[condName](el, function () {return ts.Model."+jEl.attr("an-"+nmLower)+"});";eval(evalStr)});n++;n<t.length&&i()};i()};this.RunElObserves=function(){u.forEach(function(obs){var contxt,propNameSplt,propString,i;if(!IsNullOrUndefined(obs.Elements)){for(propNameSplt=obs.PropName.split("."),propString="contxt = ts.Model",i=0;i<propNameSplt.length-1;i++)propString+="."+propNameSplt[0];eval(propString);checkAndFireFromObservable(contxt,obs,obs.PropName,contxt[obs.PropName])}})};var f=function(n){return a.Helpers.IsArray(n)&&n.toString()!=="Another.ObservableArray"},e=function(n,t,i,r,u){if(IsNullOrUndefined(u)||u.IsNullOrEmpty())throw new Error("ConverToObservable final parameter is full graph name preceding the property name eg 'Level1.Leve2.'");var f=new a.ObservableArray;return f.setObservables(t,i,r,u),n.forEach(function(n){f.pushNoFire(n)}),f},s=function(n,t){var i,r;IsNullOrUndefined(t)&&(t="");for(i in n)r=n[i],f(r)&&(n[i]=e(n[i],n,i,u,t+i))};this.Model=i;this.Bind=function(n,t,i){return IsNullOrUndefined(i)&&typeof t=="function"&&(i=t,t=undefined),typeof n=="string"?typeof i=="function"&&IsNullOrUndefined(t)?h(n,i):a.Helpers.IsArray(t)?l(n,t,i):c(n,t,i):a.Helpers.IsArray(t)?y(n,t,i):v(n,t,i),ts};var h=function(n,t){return u.push({PropName:n,Callback:t,Elements:null}),ts},c=function(n,t,i){var r;if(typeof t!="string")r=t;else{if(a.Helpers.IsUndefinedOrNull(n)||n.IsNullOrEmpty()||t.IsNullOrEmpty())throw"BindElement: propName and selector must be a string with value";r=ts.Element(t)}return u.push({PropName:n,Callback:i,Elements:[r]}),r},l=function(n,t,i){if(a.Helpers.IsUndefinedOrNull(n)||n.IsNullOrEmpty()||t.IsNullOrEmpty())throw new Error("BindElements: propName and selectors must be a string with value");var r=[];return t.forEach(function(n){r.push(ts.Element(n))}),u.push({PropName:n,Callback:i,Elements:r}),r},v=function(n,t){if(a.Helpers.IsUndefinedOrNull(n)||n.IsNullOrEmpty()||t.IsNullOrEmpty())throw"BindElementStatic: val and selector must be a string with value";var i=ts.Element(t);return i.html(n),i.val(n),i},y=function(n,t){if(a.Helpers.IsUndefinedOrNull(n)||n.IsNullOrEmpty()||t.IsNullOrEmpty())throw new Error("BindElementsStatic: val and selectors must be a string with value");var i=[];return t.forEach(function(t){var r=ts.Element(t);r.html(n);r.val(n);i.push(r)}),i};this.BindRepeater=function(n){if(typeof n.data=="string")return ts.Bind(n.data,function(t){n.data=t;(IsNullOrUndefined(n.guid)||n.guid.IsNullOrEmpty())&&(n.guid=a.Helpers.GetRandom(!0));ts.BindRepeater(n)}),ts.Element(n.selector);if(n.data.toString()!=="Another.ObservableArray")throw new Error("Presenter.BindRepeater = options.data must be an array");(IsNullOrUndefined(n.guid)||n.guid.IsNullOrEmpty())&&(n.guid=a.Helpers.GetRandom(!0));var t=a.RepeaterWrappers[n.guid];return IsNullOrUndefined(t)&&(t=new a.RepeaterWrapper(n,ts),a.RepeaterWrappers[n.guid]=t),t.Element()};this.BindRepeaterControl=function(slOrEl,opts){var outputEl,contxt,propNameSplt,propString,i,theGroup,newName,theData;if(a.Helpers.StringIsNullOrEmpty(opts.valueField)||a.Helpers.StringIsNullOrEmpty(opts.textField))throw new Error("BindRepeaterControl: options.selector, options.valueField and options.textField cannot be null or empty");if(typeof opts.data=="string")return ts.Bind(opts.data,function(n){opts.data=n;ts.BindRepeaterControl(slOrEl,opts)}),outputEl=typeof slOrEl=="object"?slOrEl:ts.Container.find(slOrEl),outputEl.length<1&&(outputEl=ts.DomHelper("<div />")),outputEl;for(propNameSplt=opts.model.split("."),propString="contxt = ts.Model",i=0;i<propNameSplt.length-1;i++)propString+="."+propNameSplt[0];eval(propString);var setContextProp=function(n){contxt[propNameSplt[propNameSplt.length-1]]=n},getContextProp=function(){return contxt[propNameSplt[propNameSplt.length-1]]},el=typeof slOrEl=="object"?slOrEl:ts.Container.find(slOrEl);el.length<=0&&(el=ts.DomHelper("<div />"));theGroup=[];el.children().remove();switch(opts.type){case"select":opts.multi===!0&&el.attr("multiple","multiple")}return(newName=a.Helpers.GetRandom(!0),opts.data===undefined||opts.data.length<=0)?el:(opts.data.forEach(function(n){var t,i,u,f,r,e,o,s,h;if(!IsNullOrUndefined(n)){e=IsNullOrUndefined(opts.controlClass)?"":" class='"+opts.controlClass+" "+opts.controlClass+"-"+opts.type+"'";o=IsNullOrUndefined(opts.labelClass)?"":" class='"+opts.labelClass+" "+opts.labelClass+"-"+opts.type+"'";switch(opts.type){case"radio":i="<input"+e+" type='radio' name='"+newName+"' value='"+n[opts.valueField]+"' />";u="<span"+o+">"+n[opts.textField]+"<\/span>";t=domHelper(i);f=domHelper(u);r="click";el.parent().children("label:first").attr("for",newName);break;case"checkbox":i="<input"+e+" type='checkbox' name='"+newName+"' value='"+n[opts.valueField]+"' />";u="<span"+o+">"+n[opts.textField]+"<\/span>";t=domHelper(i);f=domHelper(u);r="click";el.parent().children("label:first").attr("for",newName);break;case"select":s=n[opts.valueField];h=s===undefined?"":s;i="<option value='"+h+"'>"+n[opts.textField]+"<\/option>";t=domHelper(i);break;default:throw new Error("BindRepeaterControl: "+opts.type+" not implemented");}opts.type!=="select"&&(IsNullOrUndefined(r)||t.data(r+"_bound")===!0||(t.data(r+"_bound",!0),t.bind(r,function(){var i,n,r;if(el.data("change_from_element",!0),opts.multi!==!0){switch(opts.type){case"checkbox":i=t[0].checked;theGroup.forEach(function(n){n[0].checked=!1});t[0].checked=i;i?setContextProp(t.val()):setContextProp(undefined);break;default:setContextProp(t.val())}opts.type==="checkbox"}else getContextProp()===undefined&&setContextProp([]),n=[],getContextProp().forEach(function(t){n.push(t)}),n.indexOf(t.val())<0?(t[0].checked||t.attr("selected")==="selected")&&n.push(t.val()):t[0].checked&&t.attr("selected")==="selected"||(r=n.indexOf(t.val()),n.splice(r,1)),setContextProp(n)})));el.append(t);switch(opts.type){case"radio":case"checkbox":el.append(f)}theGroup.push(t)}}),opts.data!==undefined&&opts.type==="select"&&(el.data("changed_bound")!==!0&&(el.data("changed_bound",!0),el.bind("change",function(){el.data("change_from_element",!0);var n=el.val();setContextProp(n===""?undefined:IsNullOrUndefined(n)?opts.multi===!0?[]:undefined:n)})),el.data("change_from_element",!0),theData=el.val(),setContextProp(theData===""?undefined:IsNullOrUndefined(theData)?opts.multi===!0?[]:undefined:theData),el.trigger("change")),ts.Bind(opts.model,function(){if(el.data("change_from_element")===!0?el.data("change_from_element",!1):theGroup.forEach(function(n){var t=opts.multi===!0?!IsNullOrUndefined(getContextProp())&&getContextProp().indexOf(n.val())>-1:getContextProp()==n.val();switch(opts.type){case"radio":case"checkbox":n.checked=t;break;case"select":t===!0?n.attr("selected","selected"):n.removeAttr("selected")}}),!IsNullOrUndefined(opts.onChange)&&a.Helpers.IsFunc(opts.onChange))opts.onChange(getContextProp())}),el)};this.SetObserve=function(){return s(ts.Model),Object.observe(ts.Model,function(n){ts.RunConditionals();o(n,ts.Model)}),ts};this.ObserveInnerObject=function(theName){var i;if(ts.InnerObservers[theName]===undefined){var outputString="Object.observe(",modelString="ts.Model",splt=theName.split("."),joinStr=splt.join(".")+".";for(i=0;i<splt.length;i++)modelString+="['"+splt[i]+"']";return outputString="checkAndChangeArrays("+modelString+",'"+joinStr+"'); "+outputString,outputString+=modelString+", function (newVals) {",outputString+="ts.RunConditionals(); doOnObserve(newVals, "+modelString+", '"+joinStr+"');",outputString+="});",eval(outputString),ts.InnerObservers[theName]=theName,ts}};this.InnerObservers={};this.PresenterConditionals=[];this.GetService=function(n){return a.GetService(n)};this.RaiseEvent=function(n,t){return a.RaiseEvent(n,t),ts};this.SubscribeToEvent=function(n,t){return a.SubscribeToEvent(n,t),ts};this.UpdateModel=function(propName,theVal){if(propName.indexOf(".")<0)ts.Model[propName]=theVal;else{var str="ts.Model";propName.split(".").forEach(function(n){str+="['"+n+"']"});str+=" = theVal;";eval(str)}};this.Plugins=new a.PluginWrapper(ts);this.Conditionals=new a.ConditionalsWrapper(ts)};a.PluginWrapper=function(n){this.Presenter=n};a.ConditionalsWrapper=function(n){this.Presenter=n};a.AnotherApplication=function(n){var t=this;this.OnError=function(n){return window.onerror=function(t,i,r,u,f){return n(f)||!0},!0};this.Configurations=[];this.Configure=function(n){a.Helpers.IsFunc(n)&&t.Configurations.push(n)};this.Runs=[];this.Run=function(n){a.Helpers.IsFunc(n)&&this.Runs.push(n)};this.ApplicationName=n;this.CreatePresenter=function(n,i){if(a.Presenters[n]!==undefined)throw"CreatePresenter: '"+n+"' already exists.";return a.Presenters[n]=i,t};this.InitializePresenter=function(n,t,i,r){return a.InitializePresenter(n,t,i,r)};this.GetService=function(n){return a.GetService(n)};this.AddService=function(n,i,r,u){return a.AddService(n,i,r,u),t};this.RaiseEvent=function(n,t){a.RaiseEvent(n,t)};this.SubscribeToEvent=function(n,t){a.SubscribeToEvent(n,t)};this.AddDependency=function(n,i,r,u){return a.AddDependency(n,i,r,u),t};this.GetDependency=function(n){return a.GetDependency(n)};this.AddPresenterConditional=function(n,i){if(a.PresenterConditionals[n]!==undefined)throw new Error("PresenterConditional '"+n+"' already exists.");return a.PresenterConditionals[n]=i,t};this.AddPresenterPlugin=function(n,i,r){if(typeof i=="function"&&(r=i,i=undefined),a.PresenterPlugins[n]!==undefined)throw new Error("PresenterPlugin '"+n+"' already exists.");return a.PresenterPlugins[n]={wrapperProp:i,callback:r},t}};a.Applications=[];a.CreateApplication=function(n){var t=new a.AnotherApplication(n);return a.Applications.push(t),t};a.Presenters={};a.InitializePresenter=function(name,container,arrayOfParams,callback){var presenterObj,model,presenter,str,i,p;if(typeof arrayOfParams=="function"&&(callback=arrayOfParams,arrayOfParams=undefined),typeof container=="string"&&(container=a.DomHelper(container)),(IsNullOrUndefined(container)||container.length<1)&&(container=a.DomHelper("<div />")),a.RaiseEvent("OnBeginPresenterInitializing",name),presenterObj=a.Presenters[name],a.Helpers.IsUndefinedOrNull(presenterObj))throw"Initialize Presenter: Cannot find presenter '"+name+"'";if(a.RaiseEvent("OnPresenterInitializing",presenterObj),model={Ui:{},Form:{},Data:{}},presenter=new a.AnotherPresenter(name,model,container),presenter.SetObserve(),presenter.ObserveInnerObject("Ui"),presenter.ObserveInnerObject("Form"),presenter.ObserveInnerObject("Data"),IsNullOrUndefined(arrayOfParams)||arrayOfParams.IsNullOrEmpty())presenterObj(presenter);else{for(str="pCallback(presenter,",i=0;i<arrayOfParams.length;i++)p=arrayOfParams[i],str+="'"+p+"'",i!==arrayOfParams.length-1&&(str+=",");str+=");";eval(str)}return presenter.RunElObserves(),presenter.RunHtmlWrappers(),presenter.RunConditionals(),a.RaiseEvent("OnPresenterInitialized",presenter),a.Helpers.IsFunc(callback)&&callback(presenter),presenter};a.Events={};a.SubscribeToEvent=function(n,t){var i=a.CreateEvent(n);i.Subscribers.push(t)};a.RaiseEvent=function(n,t){var i=a.CreateEvent(n);t.Event={Timestamp:new Date,Name:n};i.Subscribers.forEach(function(n){n(t)})};a.CreateEvent=function(n){return a.Helpers.IsUndefinedOrNull(a.Events[n])&&(a.Events[n]={Subscribers:[]}),a.Events[n]};a.Services={};a.StaticServices={};a.AddService=function(n,t,i,r){if(IsNullOrUndefined(i)&&(r=i,i=undefined),IsNullOrUndefined(n)||IsNullOrUndefined(r)||IsNullOrUndefined(t)||t.IsNullOrEmpty()||n.IsNullOrEmpty()||!a.Helpers.IsFunc(r))throw"AddService: name, type and svc must be strings and a function respectively";if(a.Services[n]!==undefined)throw"AddService: service '"+n+"' already exists";a.Services[n]={Name:n,Dependencies:i,Service:r,Type:t}};a.GetService=function(svcName){var svc=a.Services[svcName],output,i;if(a.Helpers.IsUndefinedOrNull(svc))throw"Cannot find service '"+svcName+"'";if(svc.Type==="Static"&&a.StaticServices[svcName]!==undefined)return a.StaticServices[svcName];if(svc.Dependencies===undefined)return svc.Type==="Static"?(output=new svc.Service,a.StaticServices[output.Name]=output,output):new svc.Service;var depsString="",outputString="theService = new svc.Service(",theService=undefined;for(i=0;i<svc.Dependencies.length;i++)depsString+="var d"+i+" = a.GetDependency('"+svc.Dependencies[i]+"'); ",outputString+="d"+i,i<svc.Dependencies.length-1&&(outputString+=",");return outputString+=");",eval(depsString+outputString),theService!==undefined&&svc.Type==="Static"&&(a.StaticDependencies[svc.Name]=theService),theService};a.Dependencies={};a.StaticDependencies={};a.MockDependency=function(n,t,i){a.Dependencies[n]=undefined;a.AddDependency(n,t,[],i)};a.AddDependency=function(n,t,i,r){if(IsNullOrUndefined(r)&&(r=i,i=[]),IsNullOrUndefined(n)||IsNullOrUndefined(t)||n.IsNullOrEmpty()||t.IsNullOrEmpty()||!a.Helpers.IsFunc(r))throw"AddDependency: name and type must be a string and dep must be a function";if(a.Dependencies[n]!==undefined)throw"AddDependency: dependency '"+n+"' already exists";a.Dependencies[n]={Name:n,Dependency:r,Dependencies:i,Type:t}};a.GetDependency=function(dep){var output=a.Dependencies[dep],i,depend;if(IsNullOrUndefined(output))throw"GetDependency: '' is not a dependency";if(output.Type==="Static"&&a.StaticDependencies[name]!==undefined)return a.StaticDependencies[name];if(output.Dependencies!==undefined){var depsString="",outputString="theDep = new output.Dependency(",theDep=undefined;for(i=0;i<output.Dependencies.length;i++)depsString+="var d"+i+" = a.GetDependency('"+output.Dependencies[i]+"'); ",outputString+="d"+i,i<output.Dependencies.length-1&&(outputString+=",");return outputString+=");",eval(depsString+outputString),theDep!==undefined&&output.Type==="Static"&&(a.StaticDependencies[output.Name]=theDep),theDep}return output.Type==="Static"?(depend=new output.Dependency,a.StaticDependencies[output.Name]=depend,depend):new output.Dependency};a.PresenterConditionals={};a.PresenterPlugins={};a.Initialize=function(n){var t=0,i=Object.keys(a.PresenterPlugins),f=function(){var n=i[t],r=a.PresenterPlugins[n];a.PluginWrapper.prototype[n]=function(t,i){if(IsNullOrUndefined(r))throw new Error("PresenterPlugin '"+n+"' does not exist.");var u;u=a.Helpers.IsArray(t)?t:[t];r.callback(u,i,this.Presenter)};t++;t<i.length&&f()};i.length>0&&f();var r=0,u=Object.keys(a.PresenterConditionals),e=function(){var n=u[r],t=a.PresenterConditionals[n],i=a.PresenterConditionals[n];if(IsNullOrUndefined(i))throw new Error("PresenterConditional '"+n+"' does not exist.");a.ConditionalsWrapper.prototype[n]=function(i,r){this.Presenter.PresenterConditionals.push({name:n,selector:i,boolCallback:r,conditional:t})};r++;r<u.length&&e()};u.length>0&&e();a.DomHelper(window).load(function(){a.Applications.forEach(function(n){n.Configurations.forEach(function(t){a.Helpers.IsFunc(t)&&t(n)})});a.Applications.forEach(function(n){n.Runs.forEach(function(t){a.Helpers.IsFunc(t)&&t(n)})});a.Helpers.IsFunc(n)&&n()})};a.DependenciesApplication=a.CreateApplication("Another.Dependencies"),function(n){n.AddDependency("Http","Static",[],function(){this.Get=a.DomHelper.get;this.Post=function(n,t){return a.DomHelper.post(n,JSON.stringify(t))};this.Ajax=a.DomHelper.ajax;this.Put=function(n,t){return a.DomHelper.ajax({url:n,data:JSON.stringify(t),type:"PUT"})};this.Delete=function(n,t){return a.DomHelper.ajax({url:n,data:JSON.stringify(t),type:"DELETE"})};this.Patch=function(n,t){return a.DomHelper.ajax({url:n,data:JSON.stringify(t),type:"PATCH"})}});n.AddDependency("DomHelper","Static",[],function(){return a.DomHelper})}(a.DependenciesApplication);a.PresenterConditionalsApp=a.CreateApplication("Another.PresenterConditionalsApp"),function(n){n.AddPresenterConditional("Show",function(n,t){t?n.show():n.hide()});n.AddPresenterConditional("Enable",function(n,t){t?n.removeAttr("disabled"):n.attr("disabled","disabled")})}(a.PresenterConditionalsApp);a.PresenterPluginsApp=a.CreateApplication("Another.PresenterPluginsApp"),function(n){n.AddPresenterPlugin("Click","onClick",function(n,opts,presenter){opts.elements=[];n.forEach(function(sl){var theEl=typeof sl=="object"?sl:presenter.Container.find(sl);theEl.jquery===undefined&&(theEl=a.DomHelper(theEl));theEl.length<=0&&(theEl=presenter.DomHelper("<a />"));opts.elements.push(theEl);typeof opts.onClick=="string"&&eval("opts.onClick = function(xx,yy){presenter."+opts.onClick+"}");presenter.Container.on("click",sl,function(n){n.preventDefault();opts.onClick(n,theEl)})})});n.AddPresenterPlugin("Submit","onSubmit",function(n,opts,presenter){opts.elements=[];n.forEach(function(sl){var theForm=typeof sl=="object"?presenter.DomHelper(sl):presenter.Container.find(sl);theForm.jquery===undefined&&(theForm=a.DomHelper(theForm));theForm.length<=0&&(theForm=presenter.DomHelper("<form />"));theForm.IsDirty=function(){return theForm.data("isDirty")===!0};opts.elements.push(theForm);theForm.each(function(n,t){var i=presenter.DomHelper(t);i.change(function(){theForm.data("isDirty",!0)})});typeof opts.onSubmit=="string"&&eval("opts.onSubmit = function(xx,yy){presenter."+opts.onSubmit+"}");presenter.Container.on("submit",sl,function(n){n.preventDefault();opts.onSubmit(n,theForm);return!1})})});n.AddPresenterPlugin("Repeater","data",function(n,t,i){t.elements=[];n.forEach(function(n){var r=typeof n=="object"?n:i.Container.find(n);r.jquery===undefined&&(r=a.DomHelper(r));t.elements.push(r);i.BindRepeaterControl(r,{type:t.type,multi:t.multi,model:t.model,data:t.data,valueField:t.valueField,textField:t.textField,controlClass:t.controlClass,labelClass:t.labelClass,onChange:t.onChange})})})}(a.PresenterPluginsApp)})(Another);
/*!
 * Object.observe polyfill
 * by Massimo Artizzu (MaxArt2501)
 * 
 * https://github.com/MaxArt2501/object-observe
 * 
 * Licensed under the MIT License
 * See LICENSE for details
 */
Object.observe||function(n,t,i){var u,o,p=["add","update","delete","reconfigure","setPrototype","preventExtensions"],w=i.Node?function(n){return n&&n instanceof i.Node}:function(n){return n&&typeof n=="object"&&typeof n.nodeType=="number"&&typeof n.nodeName=="string"},b=t.isArray||function(n){return function(t){return n.call(t)==="[object Array]"}}(n.prototype.toString),g=n.defineProperties?function(t,i){var r=n.getOwnPropertyDescriptor(t,i);return r?"get"in r||"set"in r:!1}:function(){return!1},f=t.prototype.indexOf?function(n,t,i){return t.indexOf(n,i)}:function(n,t,i){for(var r=i||0;r<t.length;r++)if(t[r]===n)return r;return-1},s=typeof i.Map=="undefined"||!Map.prototype.forEach?function(){var n=[],t=[];return{size:0,has:function(t){return f(t,n)>-1},get:function(i){return t[f(i,n)]},set:function(i,r){var u=f(i,n);u===-1?(n.push(i),t.push(r),this.size++):t[u]=r},"delete":function(i){var r=f(i,n);r>-1&&(n.splice(r,1),t.splice(r,1),this.size--)},forEach:function(i){for(var r=0;r<n.length;r++)i.call(arguments[1],t[r],n[r],this)}}}:function(){return new Map},l=n.keys||function(n){var t=[];for(var i in n)n.hasOwnProperty(i)&&t.push(i);return t},h=n.getPrototypeOf||null,e=n.defineProperties?n.getOwnPropertyDescriptor:null,nt=n.is||function(n,t){return n===t?n!==0||1/n==1/t:n!==n&&t!==t},k=function(t,i,r){var f=u.get(t);f?f.handlers.set(i,y(i,t,r)):(u.set(t,f={handlers:s(),frozen:n.isFrozen?n.isFrozen(t):!1,extensible:n.isExtensible?n.isExtensible(t):!0,proto:h&&h(t),properties:w(t)?[]:l(t)}),f.handlers.set(i,y(i,t,r)),v(t,f),d(t,f),setTimeout(function e(){u.has(t)&&(c(t,f),a(f),setTimeout(e,17))},17))},d=function(n,t){var r=t.properties,u=t.values=[],i=0,f;if(e)for(f=t.descriptors=[];i<r.length;)f[i]=e(n,r[i]),u[i]=n[r[i++]];else while(i<r.length)u[i]=n[r[i++]]},c=function(){var t=e?function(n,t,i,u,f){var h=t.properties[i],o=n[h],e=t.values[i],s=t.descriptors[i];"value"in f&&(e===o?e===0&&1/e!=1/o:e===e||o===o)&&(r(t,{name:h,type:"update",object:n,oldValue:e},u),t.values[i]=o);s.configurable&&(!f.configurable||f.writable!==s.writable||f.enumerable!==s.enumerable||f.get!==s.get||f.set!==s.set)&&(r(t,{name:h,type:"reconfigure",object:n,oldValue:e},u),t.descriptors[i]=f)}:function(n,t,i,u){var o=t.properties[i],e=n[o],f=t.values[i];(f===e?f===0&&1/f!=1/e:f===f||e===e)&&(r(t,{name:o,type:"update",object:n,oldValue:f},u),t.values[i]=e)},i=e?function(n,i,u,f,o){for(var s=i.length,h;u&&s--;)i[s]!==null&&(h=e(n,i[s]),u--,h?t(n,f,s,o,h):(r(f,{name:i[s],type:"delete",object:n,oldValue:f.values[s]},o),f.properties.splice(s,1),f.values.splice(s,1),f.descriptors.splice(s,1)))}:function(n,t,i,u,f){for(var e=t.length;i&&e--;)t[e]!==null&&(r(u,{name:t[e],type:"delete",object:n,oldValue:u.values[e]},f),u.properties.splice(e,1),u.values.splice(e,1),i--)};return function(u,o,s){if(o.handlers.size&&!o.frozen){var a,p,w,d=o.values,g=o.descriptors,v=0,y,c,nt,b,k;if(o.extensible)if(a=o.properties.slice(),p=a.length,w=l(u),g){while(v<w.length)c=w[v++],y=f(c,a),k=e(u,c),y===-1?(r(o,{name:c,type:"add",object:u},s),o.properties.push(c),d.push(u[c]),g.push(k)):(a[y]=null,p--,t(u,o,y,s,k));i(u,a,p,o,s);n.isExtensible(u)||(o.extensible=!1,r(o,{type:"preventExtensions",object:u},s),o.frozen=n.isFrozen(u))}else{while(v<w.length)c=w[v++],y=f(c,a),nt=u[c],y===-1?(r(o,{name:c,type:"add",object:u},s),o.properties.push(c),d.push(nt)):(a[y]=null,p--,t(u,o,y,s));i(u,a,p,o,s)}else if(!o.frozen){for(;v<a.length;v++)c=a[v],t(u,o,v,s,e(u,c));n.isFrozen(u)&&(o.frozen=!0)}h&&(b=h(u),b!==o.proto&&(r(o,{type:"setPrototype",name:"__proto__",oldValue:o.proto}),o.proto=b))}}}(),a=function(n){n.handlers.forEach(function(n,t){n.changeRecords.length&&(t(n.changeRecords),n.changeRecords=[])})},v=function(n,t){t||(t=u.get(n));var i=t&&t.notifier;return i?i:(i={notify:function(t){var f,e,i;if(t.type,f=u.get(n),f){e={object:n};for(i in t)i!=="object"&&(e[i]=t[i]);r(f,e)}},performChange:function(t,i){if(typeof t!="string")throw new TypeError("Invalid non-string changeType");if(typeof i!="function")throw new TypeError("Cannot perform non-function");var e=u.get(n),f,s,o=i.call(arguments[2]);if(e&&c(n,e,t),e&&o&&typeof o=="object"){s={object:n,type:t};for(f in o)f!=="object"&&f!=="type"&&(s[f]=o[f]);r(e,s)}}},t&&(t.notifier=i),i)},y=function(n,t,i){var r=o.get(n),u;return r?(u=r.get(t),u?u.acceptList=i:r.set(t,u={acceptList:i,changeRecords:[]})):(r=s(),r.set(t,u={acceptList:i,changeRecords:[]}),o.set(n,r)),u},r=function(n,t,i){n.handlers.forEach(function(n){(i==null||f(i,n.acceptList)===-1)&&f(t.type,n.acceptList)>-1&&n.changeRecords.push(t)})};u=s();o=s();n.observe=function(t,i,r){if(t===null||typeof t!="object")throw new TypeError("Object.observe cannot observe non-object");if(typeof i!="function")throw new TypeError("Object.observe cannot deliver to non-function");if(n.isFrozen&&n.isFrozen(i))throw new TypeError("Object.observe cannot deliver to a frozen function object");return b(r)||(r=p),k(t,i,r),t};n.unobserve=function(n,t){if(n===null||typeof n!="object")throw new TypeError("Object.unobserve cannot unobserve non-object");if(typeof t!="function")throw new TypeError("Object.unobserve cannot deliver to non-function");var i=u.get(n),r;return i&&i.handlers.has(t)&&(c(n,i),a(i),r=o.get(t),r.size===1&&r.get(n)?o["delete"](t):r["delete"](n),i.handlers.size===1?u["delete"](n):i.handlers["delete"](t)),n};n.getNotifier=function(t){if(t===null||typeof t!="object")throw new TypeError("Object.getNotifier cannot getNotifier non-object");return n.isFrozen&&n.isFrozen(t)?null:v(t)};n.deliverChangeRecords=function(n){if(typeof n!="function")throw new TypeError("Object.deliverChangeRecords cannot deliver to non-function");var t=o.get(n);t&&t.forEach(function(t,i){c(i,u.get(i));t.changeRecords.length&&(n(t.changeRecords),t.changeRecords=[])})}}(Object,Array,this);
//# sourceMappingURL=Another.min.js.map
